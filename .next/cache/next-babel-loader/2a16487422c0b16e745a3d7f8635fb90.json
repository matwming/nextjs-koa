{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar __jsx = React.createElement;\nimport createStore from \"../store/store\";\nimport React from \"react\";\nvar isServer = false;\nvar __NEXT_REDUX_STORE__ = \"__NEXT_REDUX_STORE__\";\n\nfunction getOrCreateStore(initialState) {\n  if (isServer) {\n    return createStore(initialState);\n  }\n\n  if (!window[__NEXT_REDUX_STORE__]) {\n    window[__NEXT_REDUX_STORE__] = createStore(initialState);\n  }\n\n  return window[__NEXT_REDUX_STORE__];\n}\n\nexport default (function (Comp) {\n  var withReduxApp =\n  /*#__PURE__*/\n  function (_React$Component) {\n    _inherits(withReduxApp, _React$Component);\n\n    function withReduxApp(props) {\n      var _this;\n\n      _classCallCheck(this, withReduxApp);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(withReduxApp).call(this, props));\n      _this.reduxStore = getOrCreateStore(props.initialReduxState);\n      return _this;\n    }\n\n    _createClass(withReduxApp, [{\n      key: \"render\",\n      value: function render() {\n        var _this$props = this.props,\n            Component = _this$props.Component,\n            pageProps = _this$props.pageProps,\n            rest = _objectWithoutProperties(_this$props, [\"Component\", \"pageProps\"]);\n\n        console.log(Component, pageProps);\n\n        if (pageProps) {\n          pageProps.test = \"123\";\n        }\n\n        return __jsx(Comp, _extends({\n          Component: Component,\n          pageProps: pageProps\n        }, rest, {\n          reduxStore: this.reduxStore\n        }));\n      }\n    }]);\n\n    return withReduxApp;\n  }(React.Component);\n\n  withReduxApp.getInitialProps =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(ctx) {\n      var appProps, reduxStore;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              appProps = {};\n\n              if (!(typeof Comp.getInitialProps === \"function\")) {\n                _context.next = 5;\n                break;\n              }\n\n              _context.next = 4;\n              return Comp.getInitialProps(ctx);\n\n            case 4:\n              appProps = _context.sent;\n\n            case 5:\n              reduxStore = getOrCreateStore();\n              return _context.abrupt(\"return\", _objectSpread({}, appProps, {\n                initialReduxState: reduxStore.getState()\n              }));\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return withReduxApp;\n});","map":{"version":3,"sources":["/Users/bmyg/Desktop/nextjs/lib/withRedux.js"],"names":["createStore","React","isServer","__NEXT_REDUX_STORE__","getOrCreateStore","initialState","window","Comp","withReduxApp","props","reduxStore","initialReduxState","Component","pageProps","rest","console","log","test","getInitialProps","ctx","appProps","getState"],"mappings":";;;;;;;;;;;AAAA,OAAOA,WAAP,MAAwB,gBAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,IAAMC,QAAQ,QAAd;AAEA,IAAMC,oBAAoB,GAAG,sBAA7B;;AACA,SAASC,gBAAT,CAA0BC,YAA1B,EAAwC;AACtC,MAAIH,QAAJ,EAAc;AACZ,WAAOF,WAAW,CAACK,YAAD,CAAlB;AACD;;AACD,MAAI,CAACC,MAAM,CAACH,oBAAD,CAAX,EAAmC;AACjCG,IAAAA,MAAM,CAACH,oBAAD,CAAN,GAA+BH,WAAW,CAACK,YAAD,CAA1C;AACD;;AACD,SAAOC,MAAM,CAACH,oBAAD,CAAb;AACD;;AAED,gBAAe,UAAAI,IAAI,EAAI;AAAA,MACfC,YADe;AAAA;AAAA;AAAA;;AAEnB,0BAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,wFAAMA,KAAN;AACA,YAAKC,UAAL,GAAkBN,gBAAgB,CAACK,KAAK,CAACE,iBAAP,CAAlC;AAFiB;AAGlB;;AALkB;AAAA;AAAA,+BAMV;AAAA,0BACmC,KAAKF,KADxC;AAAA,YACCG,SADD,eACCA,SADD;AAAA,YACYC,SADZ,eACYA,SADZ;AAAA,YAC0BC,IAD1B;;AAEPC,QAAAA,OAAO,CAACC,GAAR,CAAYJ,SAAZ,EAAuBC,SAAvB;;AACA,YAAIA,SAAJ,EAAe;AACbA,UAAAA,SAAS,CAACI,IAAV,GAAiB,KAAjB;AACD;;AAED,eACE,MAAC,IAAD;AACE,UAAA,SAAS,EAAEL,SADb;AAEE,UAAA,SAAS,EAAEC;AAFb,WAGMC,IAHN;AAIE,UAAA,UAAU,EAAE,KAAKJ;AAJnB,WADF;AAQD;AArBkB;;AAAA;AAAA,IACMT,KAAK,CAACW,SADZ;;AAwBrBJ,EAAAA,YAAY,CAACU,eAAb;AAAA;AAAA;AAAA;AAAA;AAAA,6BAA+B,iBAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACzBC,cAAAA,QADyB,GACd,EADc;;AAAA,oBAEzB,OAAOb,IAAI,CAACW,eAAZ,KAAgC,UAFP;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAGVX,IAAI,CAACW,eAAL,CAAqBC,GAArB,CAHU;;AAAA;AAG3BC,cAAAA,QAH2B;;AAAA;AAKvBV,cAAAA,UALuB,GAKVN,gBAAgB,EALN;AAAA,iEAOxBgB,QAPwB;AAQ3BT,gBAAAA,iBAAiB,EAAED,UAAU,CAACW,QAAX;AARQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA/B;;AAAA;AAAA;AAAA;AAAA;;AAWA,SAAOb,YAAP;AACD,CApCD","sourcesContent":["import createStore from \"../store/store\";\nimport React from \"react\";\n\nconst isServer = typeof window === \"defined\";\n\nconst __NEXT_REDUX_STORE__ = \"__NEXT_REDUX_STORE__\";\nfunction getOrCreateStore(initialState) {\n  if (isServer) {\n    return createStore(initialState);\n  }\n  if (!window[__NEXT_REDUX_STORE__]) {\n    window[__NEXT_REDUX_STORE__] = createStore(initialState);\n  }\n  return window[__NEXT_REDUX_STORE__];\n}\n\nexport default Comp => {\n  class withReduxApp extends React.Component {\n    constructor(props) {\n      super(props);\n      this.reduxStore = getOrCreateStore(props.initialReduxState);\n    }\n    render() {\n      const { Component, pageProps, ...rest } = this.props;\n      console.log(Component, pageProps);\n      if (pageProps) {\n        pageProps.test = \"123\";\n      }\n\n      return (\n        <Comp\n          Component={Component}\n          pageProps={pageProps}\n          {...rest}\n          reduxStore={this.reduxStore}\n        />\n      );\n    }\n  }\n\n  withReduxApp.getInitialProps = async ctx => {\n    let appProps = {};\n    if (typeof Comp.getInitialProps === \"function\") {\n      appProps = await Comp.getInitialProps(ctx);\n    }\n    const reduxStore = getOrCreateStore();\n    return {\n      ...appProps,\n      initialReduxState: reduxStore.getState()\n    };\n  };\n  return withReduxApp;\n};\n"]},"metadata":{},"sourceType":"module"}